CREATE TABLE ROLES
(
	ROLE_ID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	ROLE_NAME VARCHAR(100) NOT NULL UNIQUE,
	DESCRIPTION VARCHAR(255),
	CREATEDBY_ID INT,
	CREATEDDATE DATETIME DEFAULT CURRENT_TIMESTAMP(),
	LASTUPDATEDBY_ID INT, 
	LASTMODIFIEDDATE DATETIME DEFAULT CURRENT_TIMESTAMP()	
);
 
CREATE TABLE USERS
(
	USER_ID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	USER_NAME VARCHAR(50) NOT NULL UNIQUE,
	PASSWORD VARCHAR(32),
	STATUS INT,
	CREATEDBY_ID INT,
	CREATEDDATE DATETIME DEFAULT CURRENT_TIMESTAMP(),
	LASTUPDATEDBY_ID INT, 
	LASTMODIFIEDDATE DATETIME DEFAULT CURRENT_TIMESTAMP(),
	FOREIGN KEY (CREATEDBY_ID) REFERENCES USERS(USER_ID),
	FOREIGN KEY (LASTUPDATEDBY_ID) REFERENCES USERS(USER_ID)
);

CREATE TABLE USER_DETAILS
(
	USER_DETAIL_ID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	USER_ID INT NOT NULL,
	FNAME VARCHAR(50),
	MNAME VARCHAR(50),
	LNAME VARCHAR(50),
	GENDER VARCHAR(1),
	CREATEDBY_ID INT,
	CREATEDDATE DATETIME DEFAULT CURRENT_TIMESTAMP(),
	LASTUPDATEDBY_ID INT, 
	LASTMODIFIEDDATE DATETIME DEFAULT CURRENT_TIMESTAMP(),
	FOREIGN KEY (USER_ID) REFERENCES USERS(USER_ID),
	FOREIGN KEY (CREATEDBY_ID) REFERENCES USERS(USER_ID),
	FOREIGN KEY (LASTUPDATEDBY_ID) REFERENCES USERS(USER_ID)
);


CREATE TABLE USER_ROLES
(
	USER_ROLE_ID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	ROLE_ID INT NOT NULL ,
	USER_ID INT NOT NULL ,
	CREATEDBY_ID INT,
	CREATEDDATE DATETIME DEFAULT CURRENT_TIMESTAMP(),
	LASTUPDATEDBY_ID INT, 
	LASTMODIFIEDDATE DATETIME DEFAULT CURRENT_TIMESTAMP(),
	FOREIGN KEY (ROLE_ID) REFERENCES ROLES(ROLE_ID),
	FOREIGN KEY (USER_ID) REFERENCES USERS(USER_ID),
	FOREIGN KEY (CREATEDBY_ID) REFERENCES USERS(USER_ID),
	FOREIGN KEY (LASTUPDATEDBY_ID) REFERENCES USERS(USER_ID)
);

CREATE TABLE ENTITIES
(
	ENTITY_ID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	FNAME VARCHAR(50),
	MNAME VARCHAR(50),
	LNAME VARCHAR(50),
	GENDER VARCHAR(1),
	DOB DATE NOT NULL,
	DOA DATE NOT NULL,
	MOBILENO VARCHAR(12),
	ALTERNATENO VARCHAR(12),
	EMERGENCY_CONTACT_NO VARCHAR(12),
	CREATEDBY_ID INT,
	CREATEDDATE DATETIME DEFAULT CURRENT_TIMESTAMP(),
	LASTUPDATEDBY_ID INT, 
	LASTMODIFIEDDATE DATETIME DEFAULT CURRENT_TIMESTAMP(),
	FOREIGN KEY (CREATEDBY_ID) REFERENCES USERS(USER_ID),
	FOREIGN KEY (LASTUPDATEDBY_ID) REFERENCES USERS(USER_ID)
);

CREATE TABLE STUDENTS
(
	STUDENT_ID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	ENTITY_ID INT NOT NULL,
	ENROLMENT_NO VARCHAR(50) NOT NULL UNIQUE,
	CREATEDBY_ID INT,
	CREATEDDATE DATETIME DEFAULT CURRENT_TIMESTAMP(),
	LASTUPDATEDBY_ID INT, 
	LASTMODIFIEDDATE DATETIME DEFAULT CURRENT_TIMESTAMP(),
	FOREIGN KEY (ENTITY_ID) REFERENCES ENTITIES(ENTITY_ID),
	FOREIGN KEY (CREATEDBY_ID) REFERENCES USERS(USER_ID),
	FOREIGN KEY (LASTUPDATEDBY_ID) REFERENCES USERS(USER_ID)
);
CREATE TABLE COURSES
(
	COURSE_ID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	COURSE VARCHAR(50),
	STATUS INT,
	CREATEDBY_ID INT,
	CREATEDDATE DATETIME DEFAULT CURRENT_TIMESTAMP(),
	LASTUPDATEDBY_ID INT, 
	LASTMODIFIEDDATE DATETIME DEFAULT CURRENT_TIMESTAMP(),
	FOREIGN KEY (CREATEDBY_ID) REFERENCES USERS(USER_ID),
	FOREIGN KEY (LASTUPDATEDBY_ID) REFERENCES USERS(USER_ID)
);
CREATE TABLE CLASSES
(
	CLASS_ID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	ACADEMIC_YEAR INT,
	StartDate DATE,
	ENDDATE DATE,
	COURSE_ID INT,
	CREATEDBY_ID INT,
	CREATEDDATE DATETIME DEFAULT CURRENT_TIMESTAMP(),
	LASTUPDATEDBY_ID INT, 
	LASTMODIFIEDDATE DATETIME DEFAULT CURRENT_TIMESTAMP(),
	FOREIGN KEY (COURSE_ID) REFERENCES COURSES(COURSE_ID),
	FOREIGN KEY (CREATEDBY_ID) REFERENCES USERS(USER_ID),
	FOREIGN KEY (LASTUPDATEDBY_ID) REFERENCES USERS(USER_ID)
);

CREATE TABLE CLASS_ACTIVITY
(
	CLASS_ACTIVITY_ID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	ACTIVITY VARCHAR (100) NOT NULL,
	CREATEDBY_ID INT,
	CREATEDDATE DATETIME DEFAULT CURRENT_TIMESTAMP(),
	LASTUPDATEDBY_ID INT, 
	LASTMODIFIEDDATE DATETIME DEFAULT CURRENT_TIMESTAMP(),
	FOREIGN KEY (CREATEDBY_ID) REFERENCES USERS(USER_ID),
	FOREIGN KEY (LASTUPDATEDBY_ID) REFERENCES USERS(USER_ID)
);

CREATE TABLE STUDENT_CLASS
(
    STUDENT_CLASS_ID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	STUDENT_ID INT,
	CLASS_ID INT,
	CLASS_ACTIVITY_ID INT,
	ACTIVITY_DATE   DATE,
	CREATEDBY_ID INT,
	CREATEDDATE DATETIME DEFAULT CURRENT_TIMESTAMP(),
	LASTUPDATEDBY_ID INT, 
	LASTMODIFIEDDATE DATETIME DEFAULT CURRENT_TIMESTAMP(),
	FOREIGN KEY (CREATEDBY_ID) REFERENCES USERS(USER_ID),
	FOREIGN KEY (LASTUPDATEDBY_ID) REFERENCES USERS(USER_ID),
	FOREIGN KEY (STUDENT_ID) REFERENCES STUDENTS(STUDENT_ID),
	FOREIGN KEY (CLASS_ID) REFERENCES CLASSES(CLASS_ID),
	FOREIGN KEY (CLASS_ACTIVITY_ID) REFERENCES CLASS_ACTIVITY(CLASS_ACTIVITY_ID)
);

